import subprocess # مكتبة لتنفيذ أوامر النظام
import optparse # مكتبة قديمة لقراءة خيارات سطر الأوامر (arguments)
import re


# إنشاء بارسر لقراءة الخيارات من سطر الأوامر
parser = optparse.OptionParser()
parser.add_option("-n", dest="network_interface" , help = "enter you network_interface ")  # خيار -n لتحديد اسم كرت الشبكة (مثال: eth0)
parser.add_option("-m", dest="MAC_new", help = "enter new mac")  # خيار -m لتحديد الماك الجديد
options, arguments = parser.parse_args()
if not options.network_interface:
    print("Error: please enter network interface '-n <you interface>' ")
    exit()
if not options.MAC_new:
    print("Error: please enter new mac '-m <new mac>'")
    exit()

# استدعاء الخيارات (network_interface و MAC_new) من المستخدم
options.MAC_new
options.network_interface

# إيقاف كرت الشبكة مؤقتاً
subprocess.call("sudo ifconfig " +options.network_interface +" down", shell=True)

# تغيير عنوان الماك للكرت
subprocess.call("sudo ifconfig " +options.network_interface+" hw ether "+options.MAC_new , shell=True)

# إعادة تشغيل الكرت بعد التغيير
subprocess.call("sudo ifconfig " +options.network_interface+" up", shell=True)

# طباعة رسالة تأكيد للمستخدم
print(options.network_interface,"New MAC Address :",options.MAC_new)

#فلتر ماك ادرس
ifconfig_reglts = subprocess.check_output("ifconfig " +options.network_interface , shell=True).decode("UTF-8")
MAC_Address = re.search(r"\w\w:\w\w:\w\w:\w\w:\w\w:\w\w" , ifconfig_reglts)
#print("New MAC Address :",MAC_Address[0])

if MAC_Address[0] == options.MAC_new:
    print("[+]MAC Address has changed Successfully" , options.MAC_new)
else:
    print("Error, check your commands...")

